# 도커 컨테이너와 도커 이미지

### 도커를 사용하는 이유

도커는 리눅스의 응용 프로그램을 프로세스 격리 기술들을 사용해 컨테이너로 실행하고 관리하는 오픈 소스 프로젝트이다. 리눅스 컨테이너는 이런 프로세스 격리 방식만으로 OS 가상화의 효과를 누리면서, 아주 가볍고 바른 동작을 얻어낼 수 있다. 즉, CPU나 메모리를 딱 프로세스가 필요한 만큼만 추가가 가능하고, 성능적인 손실도 최소화 할 수 있다.

도커를 이용해 프로그램을 설치하면 예상치 못한 에러도 덜 발생하며, 설치하는 과정도 훨씬 간단하다.

### 도커의 정의

> 도커는 애플리케이션을 신속하게 구축, 테스트 및 배포할 수 있는 소프트웨어 플랫폼이다. 도커는 소프트웨어 컨테이너라는 표준화된 유닛으로 패키징하며, 이 컨테이너에는 라이브러리, 시스템 도구, 코드, 런타임 등 소프트웨어를 실행하는 데 필요한 모든 것이 포함되어 있다. 도커를 사용하면 환경에 구애받지 않고 애플리케이션을 신속하게 배포 및 확장할 수 있으며 코드가 문제없이 실행될 것임을 확신할 수 있다.

### What is Container?

> 도커 컨테이너는 코드와 모든 종속성을 패키지화하여 응용 프로그램이 한 컴퓨팅 환경에서 다른 컴퓨팅 환경으로 빠르고 안정적으로 실행되도록 하는 소프트웨어의 표준 단위다.

컨테이너는 다양한 프로그램과 실행 환경을 컨테이너에 담고, 동일한 인터페이스를 제공하여 프로그램의 배포 및 관리를 단순하게 하는 기능을 한다. 즉 프로그램을 손쉽게 배포 및 관리할 수 있는 역할을 한다.

도커 컨테이너를 만들기 위해서는 도커 이미지가 필요하다. 따라서 도커 컨테이너를 이해하려면 도커 이미지를 알아야 한다.

### What is Docker Image?

> 도커 이미지는 코드, 런타임, 시스템 도구, 시스템 라이브러리 및 설정과 같은 응용 프로그램을 실행하는 데 필요한 모든 것을 포함하는 가볍고 독립적이며 실행 가능한 소프트웨어 패키지다.

아래의 도표를 살펴보면 이해하기 쉬워진다.

![image](https://github.com/YoungGyo-00/TIL/assets/89639470/46580ba6-1b9b-48c6-bc9b-de16a41f981e)

**도커 컨테이너 = 도커 이미지 인스턴스**이다. 하나의 도커 이미지로 여러 개의 도커 컨테이너를 만들어낼 수 있다.

도커 컨테이너는 도커 이미지로 만들기 때문에 도커 미지 안에는 응용 프로그램을 실행하는 데 필요한 모든 설정과 종속성이 필요하다.

도커 컨테이너는 도커 이미지를 실행한 상태라고 볼 수 있는데, 그래서 컨테이너에서 추가되거나 변하는 값은 이미지가 아닌 컨테이너 자체에 저장이 된다. 한마디로 컨테이너의 상태가 바뀌거나 삭제되더라도 이미지에는 영향을 미치지 않는다는 특징을 가지고 있다.

### 도커를 사용할 때의 흐름

도커를 사용하는 흐름은 다음과 같습니다.

1. 도커 클라이언트(CLI)에 원하는 명령을 위한 명령어 입력
2. 도커 서버(도커 데몬)가 도커 클라이언트에 입력한 명령어를 전달받으면 이미지를 생성하고, 컨테이너를 실행 → 해당 컨테이너에서 애플리케이션 실행

도커 내부에서 어떤 일이 일어나는지 프로그램을 실행시킨 결과는 다음과 같습니다.

![image](https://github.com/YoungGyo-00/TIL/assets/89639470/a3eaefc0-0e9b-42e2-950b-f11e39cd608c)

hello-world 프로그램 내부적인 처리 과정

### 초기 과정(이미지가 로컬에 없는 경우)

1. 도커 클라이언트에 명령어를 입력하면 클라이언트에서 도커 서버로 요청
2. 서버에서 이미지가 로컬에 이미 다운로드된 적이 있는지 확인
3. 기존에 내려받은 이미지가 없다면, ‘Unable to find image ‘hello-world:latest’ locally’ 문구
4. 도커 이미지가 저장된 도커(Docker Hub)에서 이미지 가져오고 로컬에 보관
5. 이미지를 이용해서 컨테이너 생성
6. 생성된 컨테이너는 이미지에서 받은 설정이나 조건에 따라 프로그램 실행

### 한번 더 실행했을 때 과정

‘Unable to find image ‘hello-world:latest’ locally’ 문구 없이 캐시 보관 장소에서 이미지를 가져와서 실행

초기 과정 3번을 제외하고 순서대로 실행된다.
